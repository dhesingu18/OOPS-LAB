import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import java.awt.*;
import java.awt.event.*;
import java.util.*;

class Flight {
    int flightNo;
    String destination;
    double price;

    Flight(int flightNo, String destination, double price) {
        this.flightNo = flightNo;
        this.destination = destination;
        this.price = price;
    }

    Object[] toRow() {
        return new Object[]{flightNo, destination, price};
    }
}

class Passenger {
    String name;
    int age;
    String contact;

    Passenger(String name, int age, String contact) {
        this.name = name;
        this.age = age;
        this.contact = contact;
    }
}

class Booking {
    Flight flight;
    Passenger passenger;

    Booking(Flight flight, Passenger passenger) {
        this.flight = flight;
        this.passenger = passenger;
    }

    String details() {
        return passenger.name + " (Age: " + passenger.age + ") → Flight " + flight.flightNo + " to " + flight.destination;
    }
}

public class FlightBookingSystemGUI extends JFrame {
    private final Flight[] flights = {
        new Flight(101, "Chennai", 3500),
        new Flight(102, "Delhi", 6500),
        new Flight(103, "Mumbai", 5000)
    };
    private final java.util.List<Booking> bookings = new ArrayList<>();

    private JTable flightTable;
    private DefaultTableModel flightTableModel;
    private JTextArea bookingArea;

    public FlightBookingSystemGUI() {
        setTitle("✈ Flight Booking System");
        setSize(700, 500);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationRelativeTo(null);
        setLayout(new BorderLayout(10, 10));

        // Top Label
        JLabel title = new JLabel("Flight Booking System", SwingConstants.CENTER);
        title.setFont(new Font("Arial", Font.BOLD, 22));
        add(title, BorderLayout.NORTH);

        // Table Panel
        flightTableModel = new DefaultTableModel(new String[]{"Flight No", "Destination", "Price (₹)"}, 0);
        for (Flight f : flights) {
            flightTableModel.addRow(f.toRow());
        }
        flightTable = new JTable(flightTableModel);
        add(new JScrollPane(flightTable), BorderLayout.CENTER);

        // Bottom Panel
        JPanel bottomPanel = new JPanel(new GridLayout(2, 1, 5, 5));

        // Buttons
        JPanel buttonPanel = new JPanel();
        JButton bookBtn = new JButton("Book Flight");
        JButton viewBookingsBtn = new JButton("View Bookings");
        JButton exitBtn = new JButton("Exit");
        buttonPanel.add(bookBtn);
        buttonPanel.add(viewBookingsBtn);
        buttonPanel.add(exitBtn);
        bottomPanel.add(buttonPanel);

        // Booking Area
        bookingArea = new JTextArea(5, 50);
        bookingArea.setEditable(false);
        bottomPanel.add(new JScrollPane(bookingArea));

        add(bottomPanel, BorderLayout.SOUTH);

        // Button Actions
        bookBtn.addActionListener(e -> openBookingForm());
        viewBookingsBtn.addActionListener(e -> displayBookings());
        exitBtn.addActionListener(e -> System.exit(0));

        setVisible(true);
    }

    private void openBookingForm() {
        int selectedRow = flightTable.getSelectedRow();
        if (selectedRow == -1) {
            JOptionPane.showMessageDialog(this, "Please select a flight to book.");
            return;
        }

        Flight selectedFlight = flights[selectedRow];

        JTextField nameField = new JTextField();
        JTextField ageField = new JTextField();
        JTextField contactField = new JTextField();

        Object[] fields = {
            "Passenger Name:", nameField,
            "Age:", ageField,
            "Contact:", contactField
        };

        int result = JOptionPane.showConfirmDialog(this, fields, "Enter Passenger Details", JOptionPane.OK_CANCEL_OPTION);
        if (result == JOptionPane.OK_OPTION) {
            try {
                String name = nameField.getText();
                int age = Integer.parseInt(ageField.getText());
                String contact = contactField.getText();

                Passenger p = new Passenger(name, age, contact);
                Booking b = new Booking(selectedFlight, p);
                bookings.add(b);

                JOptionPane.showMessageDialog(this, "✅ Booking Confirmed for " + name + " on Flight " + selectedFlight.flightNo);
            } catch (Exception ex) {
                JOptionPane.showMessageDialog(this, "Invalid input! Please try again.");
            }
        }
    }

    private void displayBookings() {
        if (bookings.isEmpty()) {
            bookingArea.setText("No bookings yet.");
        } else {
            StringBuilder sb = new StringBuilder("Confirmed Bookings:\n");
            for (Booking b : bookings) {
                sb.append("• ").append(b.details()).append("\n");
            }
            bookingArea.setText(sb.toString());
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(FlightBookingSystemGUI::new);
    }
}